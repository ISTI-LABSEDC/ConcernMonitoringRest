2022-04-05T13:03:18.882+0200 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-05T13:03:18.885+0200 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-05T13:03:18.889+0200 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-05T13:03:18.902+0200 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-05T13:03:19.053+0200 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-05T13:03:19.054+0200 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-05T13:03:19.054+0200 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-05T13:03:19.077+0200 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-05T13:03:19.078+0200 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-05T13:03:19.079+0200 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-05T13:03:19.332+0200 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-05T13:03:19.483+0200 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-05T13:03:19.504+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-05T13:03:19.699+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T09:21:30.409+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T09:21:30.411+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T09:21:30.414+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T09:21:30.423+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T09:21:30.589+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T09:21:30.589+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T09:21:30.590+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T09:21:30.626+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T09:21:30.627+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T09:21:30.629+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T09:21:30.911+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T09:21:31.067+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T09:21:31.090+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T09:21:31.280+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T09:21:36.904+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T09:25:55.489+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T09:25:55.491+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T09:25:55.494+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T09:25:55.502+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T09:25:55.707+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T09:25:55.708+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T09:25:55.708+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T09:25:55.758+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T09:25:55.758+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T09:25:55.760+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T09:25:55.999+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T09:25:56.143+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T09:25:56.170+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T09:25:56.353+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T09:26:01.893+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T09:27:42.766+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T09:27:42.768+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T09:27:42.771+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T09:27:42.780+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T09:27:42.981+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T09:27:42.981+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T09:27:42.981+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T09:27:43.011+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T09:27:43.012+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T09:27:43.013+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T09:27:43.265+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T09:27:43.409+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T09:27:43.434+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T09:27:43.619+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T09:27:49.150+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T09:30:17.721+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T09:30:17.723+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T09:30:17.726+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T09:30:17.735+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T09:30:17.966+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T09:30:17.967+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T09:30:17.968+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T09:30:18.039+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T09:30:18.039+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T09:30:18.042+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T09:30:18.301+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T09:30:18.469+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T09:30:18.494+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T09:30:18.678+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T09:30:24.212+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T09:38:11.024+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T09:38:11.026+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T09:38:11.029+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T09:38:11.037+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T09:38:11.282+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T09:38:11.283+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T09:38:11.284+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T09:38:11.315+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T09:38:11.316+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T09:38:11.317+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T09:38:11.602+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T09:38:11.759+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T09:38:11.778+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T09:38:11.957+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T09:38:17.428+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T09:38:17.459+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules  and load it into the knowledgeBase
2022-04-06T09:39:13.572+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T09:39:13.574+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T09:39:13.578+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T09:39:13.589+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T09:39:13.829+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T09:39:13.830+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T09:39:13.831+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T09:39:13.865+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T09:39:13.865+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T09:39:13.867+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T09:39:14.103+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T09:39:14.254+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T09:39:14.276+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T09:39:14.451+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T09:39:19.931+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T09:57:36.824+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T09:57:36.826+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T09:57:36.829+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T09:57:36.836+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T09:57:36.995+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T09:57:36.995+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T09:57:36.995+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T09:57:37.026+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T09:57:37.026+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T09:57:37.028+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T09:57:37.266+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T09:57:37.412+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T09:57:37.439+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T09:57:37.632+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T09:57:43.189+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T09:58:10.608+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T09:58:10.610+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T09:58:10.613+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T09:58:10.621+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T09:58:10.778+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T09:58:10.779+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T09:58:10.779+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T09:58:10.810+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T09:58:10.810+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T09:58:10.813+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T09:58:11.054+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T09:58:11.196+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T09:58:11.215+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T09:58:11.392+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T09:58:16.847+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T09:58:34.410+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T09:58:34.413+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T09:58:34.417+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T09:58:34.427+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T09:58:34.627+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T09:58:34.628+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T09:58:34.628+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T09:58:34.652+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T09:58:34.652+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T09:58:34.654+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T09:58:34.927+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T09:58:35.105+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T09:58:35.135+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T09:58:35.321+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T09:58:40.911+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T10:00:03.571+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T10:00:03.573+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T10:00:03.576+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T10:00:03.583+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T10:00:03.790+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T10:00:03.790+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T10:00:03.791+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T10:00:03.815+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T10:00:03.816+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T10:00:03.817+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T10:00:04.060+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T10:00:04.232+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T10:00:04.257+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T10:00:04.436+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T10:00:10.020+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T10:00:27.111+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T10:00:27.113+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T10:00:27.118+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T10:00:27.127+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T10:00:27.349+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T10:00:27.350+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T10:00:27.350+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T10:00:27.413+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T10:00:27.414+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T10:00:27.417+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T10:00:27.681+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T10:00:27.827+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T10:00:27.849+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T10:00:28.035+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T10:00:33.633+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T10:04:44.405+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T10:04:44.407+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T10:04:44.410+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T10:04:44.417+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T10:04:44.603+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T10:04:44.603+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T10:04:44.604+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T10:04:44.625+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T10:04:44.626+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T10:04:44.627+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T10:04:44.867+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T10:04:45.023+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T10:04:45.043+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T10:04:45.241+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T10:04:52.094+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T10:05:50.603+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T10:05:50.606+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T10:05:50.609+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T10:05:50.617+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T10:05:50.847+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T10:05:50.848+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T10:05:50.848+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T10:05:50.878+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T10:05:50.879+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T10:05:50.880+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T10:05:51.106+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T10:05:51.242+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T10:05:51.258+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T10:05:51.448+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T10:05:54.585+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T10:08:41.971+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T10:08:41.973+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T10:08:41.976+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T10:08:41.983+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T10:08:42.190+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T10:08:42.190+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T10:08:42.190+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T10:08:42.212+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T10:08:42.213+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T10:08:42.214+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T10:08:42.435+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T10:08:42.574+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T10:08:42.593+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T10:08:42.774+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T10:08:45.490+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T10:08:45.492+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T10:08:45.495+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T10:08:45.502+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T10:08:45.673+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T10:08:45.892+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T10:08:46.029+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T10:08:46.063+0200 [Thread-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T10:08:46.240+0200 [Thread-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T10:08:57.165+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T10:08:57.168+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T10:08:57.174+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T10:08:57.185+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T10:08:57.369+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T10:08:57.370+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T10:08:57.370+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T10:08:57.406+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T10:08:57.407+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T10:08:57.409+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T10:08:57.739+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T10:08:57.968+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T10:08:57.998+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T10:08:58.291+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T10:09:01.787+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T10:14:02.167+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T10:14:02.169+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T10:14:02.172+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T10:14:02.180+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T10:14:02.377+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T10:14:02.378+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T10:14:02.378+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T10:14:02.400+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T10:14:02.400+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T10:14:02.402+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T10:14:02.645+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T10:14:02.789+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T10:14:02.806+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T10:14:03.014+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T10:14:06.207+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T10:14:37.979+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T10:14:37.981+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T10:14:37.984+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T10:14:37.991+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T10:14:38.147+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T10:14:38.148+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T10:14:38.148+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T10:14:38.170+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T10:14:38.171+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T10:14:38.172+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T10:14:38.400+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T10:14:38.539+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T10:14:38.555+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T10:14:38.746+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T10:14:41.163+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T10:15:01.945+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T10:15:01.948+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T10:15:01.951+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T10:15:01.958+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T10:15:02.145+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T10:15:02.145+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T10:15:02.146+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T10:15:02.168+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T10:15:02.169+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T10:15:02.170+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T10:15:02.388+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T10:15:02.530+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T10:15:02.551+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T10:15:02.787+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T10:15:05.760+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T10:15:36.610+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T10:15:36.612+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T10:15:36.615+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T10:15:36.623+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T10:15:36.797+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T10:15:36.798+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T10:15:36.798+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T10:15:36.820+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T10:15:36.821+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T10:15:36.822+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T10:15:37.048+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T10:15:37.197+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T10:15:37.214+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T10:15:37.399+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T10:15:40.507+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T10:15:40.573+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "check that only one connection is active"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "connection",
		this.getSenderID == "probeOnSUA",
		this.getDestinationID == "Monitoring",
		this.getData == "established")		
		not(ConcernBaseEvent(
			this.getName == "connection",		
			this.getSenderID == "probeOnSUA",
			this.getDestinationID == "Monitoring",
			this.getData == "closed",
			this after $aEvent));
		
		//this not meets [2s] $aEvent);
	then
		KieLauncher.printer("More than one connection between LocalPlanner and Global Planner established. Shut down systems");	
		retract($aEvent);	
end and load it into the knowledgeBase
2022-04-06T11:55:12.493+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T11:55:12.495+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T11:55:12.498+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T11:55:12.505+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T11:55:12.695+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T11:55:12.695+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T11:55:12.695+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T11:55:12.717+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T11:55:12.717+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T11:55:12.718+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T11:55:12.935+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T11:55:13.082+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T11:55:13.099+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T11:55:13.278+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T11:55:16.177+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T11:55:16.251+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "check that only one connection is active"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "connection",
		this.getSenderID == "probeOnSUA",
		this.getDestinationID == "Monitoring",
		this.getData == "established")		
		not(ConcernBaseEvent(
			this.getName == "connection",		
			this.getSenderID == "probeOnSUA",
			this.getDestinationID == "Monitoring",
			this.getData == "closed",
			this after $aEvent));
		
		//this not meets [2s] $aEvent);
	then
		KieLauncher.printer("More than one connection between LocalPlanner and Global Planner established. Shut down systems");	
		retract($aEvent);	
end and load it into the knowledgeBase
2022-04-06T11:56:23.373+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type: it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from probeOnSUA
2022-04-06T11:56:26.375+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type: it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from probeOnSUA
2022-04-06T12:00:23.684+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T12:00:23.687+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T12:00:23.691+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T12:00:23.700+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T12:00:23.891+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T12:00:23.892+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T12:00:23.892+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T12:00:23.914+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T12:00:23.914+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T12:00:23.915+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T12:00:24.160+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T12:00:24.301+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T12:00:24.317+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T12:00:24.497+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T12:00:30.205+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T12:00:30.273+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "check that only one connection is active"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established")		
		not(ConcernBaseEvent(
			this.getName == "Connection",		
			this.getSenderID == "SUA_probe",
			this.getDestinationID == "Monitoring",
			this.getData == "closed",
			this after $aEvent));
		
		//this not meets [2s] $aEvent);
	then
		KieLauncher.printer("More than one connection between LocalPlanner and Global Planner established. Shut down systems");	
		retract($aEvent);	
end and load it into the knowledgeBase
2022-04-06T12:00:54.197+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type: it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from probeOnSUA
2022-04-06T12:00:57.199+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type: it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from probeOnSUA
2022-04-06T12:08:08.398+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T12:08:08.400+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T12:08:08.403+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T12:08:08.411+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T12:08:08.599+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T12:08:08.600+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T12:08:08.600+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T12:08:08.622+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T12:08:08.623+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T12:08:08.624+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T12:08:08.850+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T12:08:08.990+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T12:08:09.007+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T12:08:09.205+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T12:08:12.753+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T12:08:12.842+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "check that only one connection is active"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established")		
		not(ConcernBaseEvent(
			this.getName == "Connection",		
			this.getSenderID == "SUA_probe",
			this.getDestinationID == "Monitoring",
			this.getData == "closed",
			this after $aEvent));
		
		//this not meets [2s] $aEvent);
	then
		KieLauncher.printer("More than one connection between LocalPlanner and Global Planner established. Shut down systems");	
		retract($aEvent);	
end and load it into the knowledgeBase
2022-04-06T12:08:16.278+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from probeOnSUA
2022-04-06T12:08:16.278+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: probeOnSUA
Timestamp: 1649239696262
SessuinID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:08:19.282+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from probeOnSUA
2022-04-06T12:08:19.284+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: probeOnSUA
Timestamp: 1649239699275
SessuinID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:10:22.463+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T12:10:22.465+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T12:10:22.468+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T12:10:22.475+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T12:10:22.705+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T12:10:22.706+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T12:10:22.706+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T12:10:22.735+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T12:10:22.736+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T12:10:22.737+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T12:10:22.960+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T12:10:23.101+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T12:10:23.119+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T12:10:23.300+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T12:10:28.277+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T12:10:28.342+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "check that only one connection is active"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established")		
		not(ConcernBaseEvent(
			this.getName == "Connection",		
			this.getSenderID == "SUA_probe",
			this.getDestinationID == "Monitoring",
			this.getData == "closed",
			this after $aEvent));
		
		//this not meets [2s] $aEvent);
	then
		KieLauncher.printer("More than one connection between LocalPlanner and Global Planner established. Shut down systems");	
		retract($aEvent);	
end and load it into the knowledgeBase
2022-04-06T12:10:32.337+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:10:32.339+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649239832320
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:10:35.342+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:10:35.343+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649239835335
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:14:51.254+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T12:14:51.256+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T12:14:51.258+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T12:14:51.266+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T12:14:51.450+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T12:14:51.450+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T12:14:51.451+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T12:14:51.473+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T12:14:51.473+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T12:14:51.474+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T12:14:51.708+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T12:14:51.850+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T12:14:51.870+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T12:14:52.090+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T12:14:55.704+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T12:14:55.779+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "check that only one connection is active"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established");
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established")				
		not(ConcernBaseEvent(
			this.getName == "Connection",		
			this.getSenderID == "SUA_probe",
			this.getDestinationID == "Monitoring",
			this.getData == "closed",
			this after $aEvent));
		
		//this not meets [2s] $aEvent);
	then
		KieLauncher.printer("More than one connection between LocalPlanner and Global Planner established. Shut down systems");	
		retract($aEvent);	
end and load it into the knowledgeBase
2022-04-06T12:14:59.429+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:14:59.429+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240099411
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:15:02.431+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:15:02.432+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240102426
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:16:10.079+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T12:16:10.082+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T12:16:10.086+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T12:16:10.096+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T12:16:10.251+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T12:16:10.252+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T12:16:10.252+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T12:16:10.274+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T12:16:10.274+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T12:16:10.275+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T12:16:10.501+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T12:16:10.637+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T12:16:10.653+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T12:16:10.865+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T12:16:15.303+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T12:16:44.717+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T12:16:44.719+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T12:16:44.721+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T12:16:44.728+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T12:16:44.904+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T12:16:44.904+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T12:16:44.904+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T12:16:44.928+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T12:16:44.929+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T12:16:44.930+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T12:16:45.169+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T12:16:45.312+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T12:16:45.330+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T12:16:45.557+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T12:16:50.415+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T12:16:50.505+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "check that only one connection is active"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established");
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this after $aEvent)				
		not(ConcernBaseEvent(
			this.getName == "Connection",		
			this.getSenderID == "SUA_probe",
			this.getDestinationID == "Monitoring",
			this.getData == "closed",
			this after $aEvent));
		
		//this not meets [2s] $aEvent);
	then
		KieLauncher.printer("More than one connection between LocalPlanner and Global Planner established. Shut down systems");	
		retract($aEvent);	
end and load it into the knowledgeBase
2022-04-06T12:16:57.888+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:16:57.889+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240217873
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:17:01.891+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:17:01.893+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240221885
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:18:49.376+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T12:18:49.379+0200 [main] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T12:18:49.383+0200 [main] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T12:18:49.391+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T12:18:49.578+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T12:18:49.578+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T12:18:49.578+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T12:18:49.605+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T12:18:49.606+0200 [main] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T12:18:49.607+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T12:18:49.825+0200 [main] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T12:18:49.986+0200 [main] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T12:18:50.002+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T12:18:50.212+0200 [Thread-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T12:18:56.142+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T12:18:56.228+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "check that only one connection is active"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established");
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this after $aEvent)				
		not(ConcernBaseEvent(
			this.getName == "Connection",		
			this.getSenderID == "SUA_probe",
			this.getDestinationID == "Monitoring",
			this.getData == "closed",
			this after $aEvent));
		
		//this not meets [2s] $aEvent);
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established. Shut down systems");	
		retract($aEvent);	
end and load it into the knowledgeBase
2022-04-06T12:19:00.752+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:19:00.753+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240340738
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:19:04.753+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:19:04.754+0200 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240344750
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:23:08.730+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:23:08.730+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240588717
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:23:12.732+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:23:12.733+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: closed
SenderID: SUA_probe
Timestamp: 1649240592729
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:23:25.483+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:23:25.483+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240605471
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:23:29.484+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:23:29.484+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: closed
SenderID: SUA_probe
Timestamp: 1649240609482
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:23:44.523+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:23:44.524+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: closed
SenderID: SUA_probe
Timestamp: 1649240624511
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:23:48.528+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:23:48.530+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: closed
SenderID: SUA_probe
Timestamp: 1649240628523
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:24:01.751+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:24:01.751+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240641735
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:24:05.754+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:24:05.755+0200 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240645750
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:25:21.821+0200 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:25:21.821+0200 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240721808
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:25:25.825+0200 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:25:25.827+0200 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: closed
SenderID: SUA_probe
Timestamp: 1649240725820
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:25:25.829+0200 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:25:25.830+0200 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240725823
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:25:33.299+0200 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:25:33.299+0200 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240733287
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:25:37.300+0200 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:25:37.300+0200 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: closed
SenderID: SUA_probe
Timestamp: 1649240737298
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:25:37.301+0200 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne received an event of type:
it.cnr.isti.labsedc.concern.event.ConcernBaseEvent in the stream, sent from SUA_probe
2022-04-06T12:25:37.301+0200 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - with data:
Name: Connection
Destination: Monitoring
Data: established
SenderID: SUA_probe
Timestamp: 1649240737299
SessionID: noSession
Checksum: noChecksum
CepType: DROOLS
2022-04-06T12:27:07.078+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2022-04-06T12:27:07.080+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2022-04-06T12:27:07.084+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2022-04-06T12:27:07.092+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2022-04-06T12:27:07.266+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2022-04-06T12:27:07.266+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2022-04-06T12:27:07.267+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2022-04-06T12:27:07.308+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2022-04-06T12:27:07.308+0200 [grizzly-http-server-0] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2022-04-06T12:27:07.310+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2022-04-06T12:27:07.559+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Connected successfully to concern on localhost
2022-04-06T12:27:07.711+0200 [grizzly-http-server-0] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2022-04-06T12:27:07.735+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2022-04-06T12:27:07.946+0200 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2022-04-06T12:27:13.503+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end and load it into the knowledgeBase
2022-04-06T12:27:13.575+0200 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "check that only one connection is active"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established");
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this after $aEvent)				
		not(ConcernBaseEvent(
			this.getName == "Connection",		
			this.getSenderID == "SUA_probe",
			this.getDestinationID == "Monitoring",
			this.getData == "closed",
			this after $aEvent));
		
		//this not meets [2s] $aEvent);
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established. Shut down systems");	
		retract($aEvent);
		retract($bEvent);	
end and load it into the knowledgeBase
