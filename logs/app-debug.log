2023-01-19T09:09:11.500+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T09:09:11.502+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T09:09:11.506+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T09:09:11.517+0100 [grizzly-http-server-5] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2023-01-19T09:09:11.668+0100 [grizzly-http-server-5] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2023-01-19T09:09:11.668+0100 [grizzly-http-server-5] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2023-01-19T09:09:11.668+0100 [grizzly-http-server-5] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2023-01-19T09:09:11.690+0100 [grizzly-http-server-5] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2023-01-19T09:09:11.690+0100 [grizzly-http-server-5] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2023-01-19T09:09:11.692+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T09:09:11.910+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T09:09:11.930+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T09:09:12.139+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T09:09:12.230+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end
2023-01-19T09:09:12.699+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T09:09:12.700+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T09:09:12.700+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 1
2023-01-19T09:10:11.238+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T09:10:11.340+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T09:10:11.340+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T09:10:11.341+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
2023-01-19T09:10:44.425+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules Ciao cane cuai
2023-01-19T11:34:44.438+0100 [grizzly-http-server-10] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T11:34:44.440+0100 [grizzly-http-server-10] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T11:34:44.444+0100 [grizzly-http-server-10] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T11:34:44.453+0100 [grizzly-http-server-10] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2023-01-19T11:34:44.630+0100 [grizzly-http-server-10] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2023-01-19T11:34:44.630+0100 [grizzly-http-server-10] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2023-01-19T11:34:44.631+0100 [grizzly-http-server-10] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2023-01-19T11:34:44.666+0100 [grizzly-http-server-10] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2023-01-19T11:34:44.667+0100 [grizzly-http-server-10] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2023-01-19T11:34:44.669+0100 [grizzly-http-server-10] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T11:34:44.935+0100 [grizzly-http-server-10] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T11:34:44.959+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T11:34:45.185+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T11:34:45.260+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T11:34:45.807+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T11:34:45.808+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T12:04:41.733+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T12:04:41.736+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T12:04:41.741+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T12:04:41.753+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2023-01-19T12:04:41.931+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2023-01-19T12:04:41.931+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2023-01-19T12:04:41.932+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2023-01-19T12:04:41.960+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2023-01-19T12:04:41.960+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2023-01-19T12:04:41.962+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T12:04:42.223+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T12:04:42.246+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T12:04:42.501+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T12:04:42.543+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules             
2023-01-19T12:04:42.591+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T12:04:42.591+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: defaultpkg 0
2023-01-19T12:04:42.591+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 0
2023-01-19T12:07:45.010+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T12:07:45.490+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T12:07:45.491+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: defaultpkg 0
2023-01-19T12:07:45.491+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T12:08:06.415+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end
2023-01-19T12:08:06.591+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T12:08:06.592+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T12:08:06.592+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: defaultpkg 0
2023-01-19T12:08:06.592+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
2023-01-19T12:09:20.160+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end
2023-01-19T12:09:20.233+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T12:09:20.234+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T12:09:20.234+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: defaultpkg 0
2023-01-19T12:09:20.234+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
2023-01-19T12:09:38.693+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T12:09:38.757+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T12:09:59.968+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T12:10:01.287+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: defaultpkg 0
2023-01-19T12:10:01.912+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
2023-01-19T12:20:56.829+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T12:20:56.831+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T12:20:56.834+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T12:20:56.843+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2023-01-19T12:20:57.034+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2023-01-19T12:20:57.034+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2023-01-19T12:20:57.034+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2023-01-19T12:20:57.062+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2023-01-19T12:20:57.062+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2023-01-19T12:20:57.064+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T12:20:57.340+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T12:20:57.363+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T12:20:57.621+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T12:20:57.664+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T12:20:58.193+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T12:21:01.575+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T12:22:47.094+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T12:22:47.181+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T12:22:47.181+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T12:29:26.488+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T12:29:26.490+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T12:29:26.499+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T12:29:26.513+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2023-01-19T12:29:26.745+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2023-01-19T12:29:26.745+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2023-01-19T12:29:26.746+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2023-01-19T12:29:26.772+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2023-01-19T12:29:26.772+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2023-01-19T12:29:26.774+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T12:29:26.999+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T12:29:27.019+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T12:29:27.245+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T12:29:27.323+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end
2023-01-19T12:29:27.769+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T12:29:27.769+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T12:29:27.770+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 1
2023-01-19T12:29:41.123+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end
2023-01-19T12:29:41.197+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T12:29:41.198+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T12:29:41.198+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 1
2023-01-19T18:29:48.780+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T18:29:48.784+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T18:29:48.788+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T18:29:48.802+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2023-01-19T18:29:48.968+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2023-01-19T18:29:48.968+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2023-01-19T18:29:48.968+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2023-01-19T18:29:48.996+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2023-01-19T18:29:48.997+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2023-01-19T18:29:48.998+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T18:29:49.259+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T18:29:49.280+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T18:29:49.505+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T18:29:49.579+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T18:29:50.068+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T18:30:33.610+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T18:30:33.613+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T18:30:33.616+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T18:30:33.627+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2023-01-19T18:30:33.784+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2023-01-19T18:30:33.784+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2023-01-19T18:30:33.785+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2023-01-19T18:30:33.811+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2023-01-19T18:30:33.811+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2023-01-19T18:30:33.813+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T18:30:34.051+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T18:30:34.074+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T18:30:34.309+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T18:30:34.375+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T18:30:34.914+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T18:31:30.738+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end

2023-01-19T18:31:30.754+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T18:50:45.209+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T18:50:45.211+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T18:50:45.214+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T18:50:45.224+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2023-01-19T18:50:45.381+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2023-01-19T18:50:45.381+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2023-01-19T18:50:45.382+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2023-01-19T18:50:45.409+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2023-01-19T18:50:45.410+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2023-01-19T18:50:45.412+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T18:50:45.663+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T18:50:45.687+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T18:50:45.904+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T18:50:45.987+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T18:50:46.597+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T18:51:02.000+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T18:52:54.619+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T18:52:54.679+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T18:53:00.656+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T18:56:24.860+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end
2023-01-19T18:56:24.999+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T19:05:18.991+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T19:05:18.993+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T19:05:18.996+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T19:05:19.005+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2023-01-19T19:05:19.160+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2023-01-19T19:05:19.160+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2023-01-19T19:05:19.160+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2023-01-19T19:05:19.187+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2023-01-19T19:05:19.188+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2023-01-19T19:05:19.189+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T19:05:19.441+0100 [grizzly-http-server-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T19:05:19.462+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T19:05:19.692+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T19:05:19.766+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end

2023-01-19T19:05:19.817+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T19:05:49.362+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 0
2023-01-19T19:06:06.080+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T19:06:06.557+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T19:06:19.629+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T19:26:29.889+0100 [grizzly-http-server-4] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T19:26:29.891+0100 [grizzly-http-server-4] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T19:26:29.894+0100 [grizzly-http-server-4] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T19:26:29.903+0100 [grizzly-http-server-4] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2023-01-19T19:26:30.163+0100 [grizzly-http-server-4] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2023-01-19T19:26:30.164+0100 [grizzly-http-server-4] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2023-01-19T19:26:30.164+0100 [grizzly-http-server-4] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2023-01-19T19:26:30.193+0100 [grizzly-http-server-4] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2023-01-19T19:26:30.193+0100 [grizzly-http-server-4] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2023-01-19T19:26:30.195+0100 [grizzly-http-server-4] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T19:26:30.439+0100 [grizzly-http-server-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T19:26:30.461+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T19:26:30.716+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T19:26:30.764+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T19:26:31.219+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T19:26:35.205+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
