2023-01-18T23:17:02.032+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-18T23:17:02.035+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-18T23:17:02.038+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-18T23:17:02.271+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-18T23:17:02.508+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-18T23:17:02.534+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-18T23:17:02.768+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-18T23:17:02.829+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules  package it.cnr.isti.labsedc.concern.event; import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent; declare ConcernAbstractEvent    @role( event )    @timestamp( timestamp ) end
2023-01-18T23:17:02.878+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-18T23:17:02.879+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 0
2023-01-18T23:17:27.567+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules  package it.cnr.isti.labsedc.concern.event; import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent; declare ConcernAbstractEvent    @role( event )    @timestamp( timestamp ) end
2023-01-18T23:17:27.589+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-18T23:17:27.589+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 0
2023-01-18T23:29:12.394+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules  package it.cnr.isti.labsedc.concern.event; import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent; declare ConcernAbstractEvent    @role( event )    @timestamp( timestamp ) end
2023-01-18T23:29:12.401+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-18T23:29:12.402+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 0
2023-01-18T23:53:45.786+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-18T23:53:45.789+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-18T23:53:45.792+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-18T23:53:46.042+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-18T23:53:46.287+0100 [grizzly-http-server-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-18T23:53:46.307+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-18T23:53:46.531+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-18T23:54:00.098+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end
2023-01-18T23:54:00.660+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-18T23:54:00.661+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-18T23:54:00.661+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 1
2023-01-18T23:54:29.197+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-18T23:54:29.343+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-18T23:54:29.343+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-18T23:54:29.344+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
2023-01-19T00:01:24.903+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end

2023-01-19T00:01:24.927+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:01:24.928+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T00:01:24.928+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
2023-01-19T00:02:29.057+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end

2023-01-19T00:02:29.077+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:02:29.077+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T00:02:29.077+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
2023-01-19T00:03:39.078+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end
2023-01-19T00:03:39.141+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:03:39.142+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T00:03:39.142+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
2023-01-19T00:05:01.374+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T00:05:01.377+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T00:05:01.380+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T00:05:01.573+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T00:05:01.808+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T00:05:01.827+0100 [Thread-26] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T00:05:02.047+0100 [Thread-26] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T00:05:07.448+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:05:08.021+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:05:08.021+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:08:49.415+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:08:49.511+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:08:49.511+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:12:02.126+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2023-01-19T00:12:02.128+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2023-01-19T00:12:02.132+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2023-01-19T00:12:02.343+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.storage.MySQLStorageController - Setting up storage with default parameters
2023-01-19T00:12:02.595+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2023-01-19T00:12:02.616+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2023-01-19T00:12:02.860+0100 [Thread-24] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/ConcernMonitoringRest/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2023-01-19T00:12:08.612+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:12:09.135+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:12:09.135+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:13:48.440+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:13:48.527+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:13:48.528+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:14:17.255+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:14:17.318+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:14:17.318+0100 [ActiveMQ Session Task-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:14:55.426+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:14:55.483+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:14:55.484+0100 [ActiveMQ Session Task-3] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:16:16.436+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:16:16.501+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:16:16.501+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:16:19.915+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:16:19.968+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:16:19.969+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:16:22.457+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:16:22.509+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:16:22.510+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:16:24.041+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:16:24.077+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:16:24.078+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:16:29.894+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:16:29.939+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:16:29.939+0100 [ActiveMQ Session Task-4] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:17:38.475+0100 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:17:38.515+0100 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:17:38.516+0100 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:18:08.479+0100 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:18:08.527+0100 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:18:08.527+0100 [ActiveMQ Session Task-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:19:57.916+0100 [ActiveMQ Session Task-6] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:19:57.956+0100 [ActiveMQ Session Task-6] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:19:57.957+0100 [ActiveMQ Session Task-6] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:20:17.379+0100 [ActiveMQ Session Task-6] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:20:17.413+0100 [ActiveMQ Session Task-6] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:20:17.413+0100 [ActiveMQ Session Task-6] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:20:36.896+0100 [ActiveMQ Session Task-6] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end
2023-01-19T00:20:36.915+0100 [ActiveMQ Session Task-6] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:20:36.915+0100 [ActiveMQ Session Task-6] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:23:22.504+0100 [ActiveMQ Session Task-7] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernBaseEvent
    @role( event )
    @timestamp( timestamp )
end

rule "manage1"
no-loop
salience 10
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false);
	then
		$aEvent.setConsumed(true);
		update($aEvent);
end


rule "manage2"
no-loop
salience 100
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "closed",
		this.getConsumed == false,
		this after $aEvent);				
	then
		retract($aEvent);
		retract($bEvent);	
end

rule "check that only one connection is active"
no-loop
salience 200
dialect "java" 
	when
		$aEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == true);
		
		$bEvent : ConcernBaseEvent(
		this.getName == "Connection",
		this.getSenderID == "SUA_Probe",
		this.getDestinationID == "Monitoring",
		this.getData == "established",
		this.getConsumed == false,
		this after $aEvent);				
	then
		KieLauncher.printWarning("More than one connection between LocalPlanner and Global Planner established.\nShut down systems");	
		retract($aEvent);
		retract($bEvent);	
end
2023-01-19T00:23:22.551+0100 [ActiveMQ Session Task-7] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:23:22.551+0100 [ActiveMQ Session Task-7] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:23:33.741+0100 [ActiveMQ Session Task-7] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end

2023-01-19T00:23:33.755+0100 [ActiveMQ Session Task-7] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:23:33.756+0100 [ActiveMQ Session Task-7] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2023-01-19T00:25:37.725+0100 [ActiveMQ Session Task-8] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end
2023-01-19T00:25:37.852+0100 [ActiveMQ Session Task-8] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:25:37.852+0100 [ActiveMQ Session Task-8] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T00:25:37.852+0100 [ActiveMQ Session Task-8] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
2023-01-19T00:28:46.278+0100 [ActiveMQ Session Task-9] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end
2023-01-19T00:28:46.316+0100 [ActiveMQ Session Task-9] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:28:46.316+0100 [ActiveMQ Session Task-9] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T00:28:46.316+0100 [ActiveMQ Session Task-9] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
2023-01-19T00:30:43.752+0100 [ActiveMQ Session Task-10] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created on: Mar 18, 2022
package it.cnr.isti.labsedc.concern.event;

import it.cnr.isti.labsedc.concern.event.ConcernBaseEvent;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernNetworkEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

dialect "java"

declare ConcernAbstractEvent
    @role( event )
    @timestamp( timestamp )
end


rule "observe mean connection value for avoiding network congestion"
no-loop
salience 10
dialect "java"
when 
   	Number(doubleValue > 5) from accumulate(
		ConcernNetworkEvent($amount : getConnectionAmount(), name == "connectionEvent", senderID == "probeROS" ) over window:time(30s),
   	 		average($amount)  
   	 		
   	 	)
    then
        System.out.println("Failure detected");
end
2023-01-19T00:30:43.781+0100 [ActiveMQ Session Task-10] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2023-01-19T00:30:43.782+0100 [ActiveMQ Session Task-10] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: java.lang 0
2023-01-19T00:30:43.782+0100 [ActiveMQ Session Task-10] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
